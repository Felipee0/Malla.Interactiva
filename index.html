import { useState, useEffect } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Progress } from "@/components/ui/progress";
import { CheckCircle } from "lucide-react";

const semesters = [
  {
    name: "Semestre 1",
    credits: 16,
    subjects: [
      "Humanidades I",
      "Inglés I",
      "Problemas Sociales Globales",
      "Aspectos Psicológicos del Comportamiento Humano",
      "Filosofía e Historia de la Psicología",
      "Psicobiología"
    ]
  },
  {
    name: "Semestre 2",
    credits: 19,
    subjects: [
      "Enfoque y Tendencias en Psicología Dinámica",
      "Enfoque y Tendencias en Psicología Conductual",
      "Estadística Descriptiva e Inferencial",
      "Procesos Psicológicos Básicos y Complejos",
      "Inglés II",
      "Humanidades II",
      "Neurociencia Cognitiva y del Comportamiento"
    ]
  },
  {
    name: "Semestre 3",
    credits: 18,
    subjects: [
      "Psicología Diferencial",
      "Enfoque y Tendencias en Psicología Social",
      "Enfoque y Tendencias en Psicología Cognitiva",
      "Enfoque y Tendencias en Psicología Sistémica",
      "Medición y Evaluación de Procesos Psicológicos Básicos y Complejos",
      "Inglés III",
      "Humanidades III"
    ]
  },
  {
    name: "Semestre 4",
    credits: 18,
    subjects: [
      "Psicopatología",
      "Procesos Psicosociales de los Grupos y la Familia",
      "Enfoque y Tendencias en Psicología Humanista",
      "Semiología Psicológica",
      "Psicología Evolutiva",
      "Neuropsicología",
      "Inglés IV"
    ]
  },
  {
    name: "Semestre 5",
    credits: 20,
    subjects: [
      "Psicología en el Campo de las Organizaciones",
      "Psicología en el Campo Social Comunitario",
      "Psicología en el Campo Jurídico",
      "Modelos Psicodiagnósticos",
      "Psicología en el Campo Educativo",
      "Epistemologías de las Ciencias Sociales"
    ]
  },
  {
    name: "Semestre 6",
    credits: 19,
    subjects: [
      "Metodologías y Técnicas de Intervención Psicosocial",
      "Práctica Clínica",
      "Curso Optativo I",
      "Diseños de Investigación",
      "Informes Psicológicos",
      "Institucional I"
    ]
  },
  {
    name: "Semestre 7",
    credits: 18,
    subjects: [
      "Electiva I",
      "Práctica Optativa I",
      "Curso Optativo II",
      "Formulación de Proyectos de Investigación e Intervención Social",
      "Institucional II",
      "Problemática Social Colombiana"
    ]
  },
  {
    name: "Semestre 8",
    credits: 19,
    subjects: [
      "Electiva II",
      "Institucional III",
      "Práctica Optativa II",
      "Trabajo de Grado",
      "Dinámica Sociocultural Colombiana",
      "Curso Optativo III"
    ]
  }
];

export default function PensumInteractivo() {
  const [completed, setCompleted] = useState(() => {
    const stored = localStorage.getItem("completedSemesters");
    return stored ? JSON.parse(stored) : Array(semesters.length).fill(false);
  });

  useEffect(() => {
    localStorage.setItem("completedSemesters", JSON.stringify(completed));
  }, [completed]);

  const toggleComplete = (index) => {
    const newCompleted = [...completed];
    newCompleted[index] = !newCompleted[index];
    setCompleted(newCompleted);
  };

  const completedCount = completed.filter(Boolean).length;
  const progress = (completedCount / semesters.length) * 100;

  const messages = [
    "¡Vamos, tú puedes!",
    "¡Excelente progreso!",
    "¡Ya falta poco!",
    "¡Casi terminas!",
    "¡Lo lograste!"
  ];

  const getMotivationalMessage = () => {
    const index = Math.min(
      Math.floor((completedCount / semesters.length) * messages.length),
      messages.length - 1
    );
    return messages[index];
  };

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-4 text-center">Pénsum de Psicología Bogotá</h1>
      <Progress value={progress} className="mb-4" />
      <p className="text-center mb-6 font-medium">{getMotivationalMessage()}</p>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {semesters.map((sem, i) => (
          <Card
            key={i}
            className={`transition-opacity duration-300 ${
              completed[i] ? "opacity-50" : "opacity-100"
            }`}
          >
            <CardContent className="p-4">
              <div className="flex justify-between items-center mb-2">
                <h2 className="text-lg font-semibold">{sem.name}</h2>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={() => toggleComplete(i)}
                >
                  <CheckCircle className="w-4 h-4 mr-1" /> Marcar
                </Button>
              </div>
              <ul className="mb-2">
                {sem.subjects.map((subj, j) => (
                  <li key={j} className="text-sm list-disc ml-4">
                    {subj}
                  </li>
                ))}
              </ul>
              <p className="text-right text-sm font-medium">Total: {sem.credits} créditos</p>
            </CardContent>
          </Card>
        ))}
      </div>
    </div>
  );
}



